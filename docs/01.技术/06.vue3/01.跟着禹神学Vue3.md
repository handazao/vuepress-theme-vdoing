---
title: vue3æ ¸å¿ƒæŠ€æœ¯
tags: 
  - vue3
categories: 
  - vue3
  - æŠ€æœ¯
permalink: /pages/20240627/
author: 
  name: handazao
  link: https://github.com/handazao
date: 2024-06-27 09:28:51
---





[TOC]

# å¼€ç¯‡æ€»ç»“
> é¦–å…ˆå£°æ˜ï¼šè¿™ç¯‡ç¬”è®°ä¸­æ˜¯åœ¨å­¦ä¹ ç¦¹ç¥æœ€æ–°Vue3æ•™ç¨‹è®°ä¸‹æ¥çš„ï¼Œå…¶ä¸­æœ‰ä¸€äº›è‡ªå·±å†™çš„ç¬”è®°è§è§£ã€æ¬ç¦¹ç¥ã€vueã€viteå®˜ç½‘çš„ä¸€äº›ç¬”è®°ã€‚ä¸»è¦ç›®çš„è¿˜æ˜¯ç»™è‡ªå·±å¤šä¸€ç‚¹çŸ¥è¯†ç‚¹çš„æ€»ç»“ã€‚å…¶å®ä¸€éä¸‹æ¥ï¼ŒåŸºæœ¬å¤§éƒ¨åˆ†éƒ½ä¼šï¼Œæ‰€ä»¥å­¦ä¹ ä¼šå¾ˆå¿«ã€‚æœ‰å‡ ç‚¹æˆ‘å¾—å¥½å¥½åœ¨ä¸‹é¢æ€»ç»“ã€‚

**1.å­¦ä¹ åˆ°çš„æ–°ç‚¹**
- propså’Œprovideä¼ å€¼å¯ä»¥é€šè¿‡ä¼ å‡½æ•°ç»™ä¸‹é¢çš„ç»„ä»¶ï¼Œç»„ä»¶è°ƒç”¨åä¼ å‚å¯ä»¥æ›´æ”¹çˆ¶å…ƒç´ ã€‚
- ä¸€ä¸ªreactiveå“åº”å¼å¯¹è±¡ä¸­åŒ…å«æœ‰refç±»å‹æ•°æ®ï¼Œé€šè¿‡reactiveå¯ä»¥ç›´æ¥è·å–æ•°æ®ï¼Œæœ‰è§£åŒ…çš„è¿‡ç¨‹
- æ–°äº†è§£çš„mittè¿›è¡Œç»„ä»¶é—´çš„é€šä¿¡
- ç¦¹ç¥yydsï¼Œä½œç”¨åŸŸæ’æ§½æ¯æ¬¡çœ‹åˆ°éƒ½ä¼šæœ‰ä¸ä¸€æ ·çš„è§è§£ï¼Œä½†æ˜¯ä¸ç”¨å®¹æ˜“å¿˜ï¼Œè¿™æ¬¡è®²çš„ä¾‹å­å¾ˆè®©äººè®°å¿†æ·±åˆ»
- position:fixedå®šä½å…¥å£çˆ¶å…ƒç´ ä¸­æœ‰filter CSSå±æ€§ï¼Œä¹Ÿä¼šå’Œposition:relative;ä¸€æ ·ã€‚

**2.å­¦ä¹ çš„å»ºè®®**
- è™½ç„¶ä¹‹å‰é€šè¿‡å„ä¸ªæ–¹é¢èµ„æºå­¦ä¹ vueï¼Œå…¶ä¸­ä¸»è¦æ˜¯é€šè¿‡å®˜ç½‘å’Œç¦¹ç¥çš„vue2è§†é¢‘å­¦ä¹ ï¼Œå­¦ä¹ ä¹Ÿç®€å•ï¼Œä½†æ˜¯å¾ˆé‡è¦çš„ä¸€ç‚¹ï¼Œå°±æ˜¯è¦å»å¤šç»ƒï¼Œå¤šæ¥è§¦ï¼Œè¦ä¸ç„¶å¾ˆå®¹æ˜“å¿˜çš„ã€‚
- æƒ³å­¦ä¹ æ›´å¤šçš„ä¸œè¥¿ï¼Œçœ‹å®˜ç½‘æŒºå¥½çš„ï¼Œå½“ç„¶å¬è€å¸ˆè®²å¯èƒ½ä¼šå¯¹ä¸€ä¸ªçŸ¥è¯†ç‚¹è±ç„¶å¼€æœ—ã€‚


# 1.åˆ›å»º Vue3 å·¥ç¨‹

## 1.1 ã€åŸºäº vue-cli åˆ›å»ºã€‘

> å¤‡æ³¨ï¼šç°åœ¨å®˜æ–¹æ¨èä½¿ç”¨ create-vue æ¥åˆ›å»ºåŸºäº Vite çš„æ–°é¡¹ç›®ã€‚

```bash
## æŸ¥çœ‹ @vue/cliç‰ˆæœ¬ï¼Œç¡®ä¿@vue/cliç‰ˆæœ¬åœ¨4.5.0ä»¥ä¸Š
vue --version
vue -V
## å®‰è£…æˆ– å‡çº§ä½ çš„ @vue/cli
npm install -g @vue/cli
## æ‰§è¡Œåˆ›å»ºå‘½ä»¤
vue create vue_test
## éšåé€‰æ‹© 3.x
> Default ([Vue 3] babel, eslint)
  Default ([Vue 2] babel, eslint)

## ä¸‹é¢åŸºäºwebpackæ­å»ºé¡¹ç›®æˆåŠŸåæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å°±æ˜¯æˆåŠŸåˆ›å»ºVue3é¡¹ç›®ï¼ï¼ï¼
? Please pick a preset: Default ([Vue 3] babel, eslint)


Vue CLI v5.0.8
âœ¨  Creating project in F:\æ¡Œé¢\vue_test.
ğŸ—ƒ  Initializing git repository...
âš™ï¸  Installing CLI plugins. This might take a while...


added 864 packages in 35s
ğŸš€  Invoking generators...
ğŸ“¦  Installing additional dependencies...


added 103 packages in 7s
âš“  Running completion hooks...

ğŸ“„  Generating README.md...

ğŸ‰  Successfully created project vue_test.
ğŸ‘‰  Get started with the following commands:

 $ cd vue_test
 $ npm run serve
```

## 1.2 ã€åŸºäº Vite åˆ›å»ºã€‘ï¼ˆVue å®˜æ–¹æ¨èï¼‰

```bash
## åˆ›å»ºå‘½ä»¤
npm create vue@latest
## ä¸€äº›å¯é€‰é¡¹
âœ” Project name: â€¦ <your-project-name>
âœ” Add TypeScript? â€¦ No / Yes
âœ” Add JSX Support? â€¦ No / Yes
âœ” Add Vue Router for Single Page Application development? â€¦ No / Yes
âœ” Add Pinia for state management? â€¦ No / Yes
âœ” Add Vitest for Unit testing? â€¦ No / Yes
âœ” Add an End-to-End Testing Solution? â€¦ No / Cypress / Playwright
âœ” Add ESLint for code quality? â€¦ No / Yes
âœ” Add Prettier for code formatting? â€¦ No / Yes

Scaffolding project in ./<your-project-name>...
Done.
## åœ¨é¡¹ç›®è¢«åˆ›å»ºåï¼Œé€šè¿‡ä»¥ä¸‹æ­¥éª¤å®‰è£…ä¾èµ–å¹¶å¯åŠ¨å¼€å‘æœåŠ¡å™¨
> cd <your-project-name>
> npm install
> npm run dev
```

**æ€»ç»“ï¼š**

- Vite é¡¹ç›®ä¸­ï¼Œindex.html æ˜¯é¡¹ç›®çš„å…¥å£æ–‡ä»¶ï¼Œåœ¨é¡¹ç›®çš„æœ€å¤–å±‚ã€‚
- åŠ è½½ index.html åï¼ŒVite è§£æ `<script type="module" src="xxxxx"></script>`æŒ‡å‘çš„ JavaScriptã€‚
- Vue3 ä¸­æ˜¯é€šè¿‡ createApp å‡½æ•°åˆ›å»ºä¸€ä¸ªå®ä¾‹åº”ç”¨çš„ã€‚

## 1.3 ã€åŸºäº Vite å®˜æ–¹ create-vite åˆ›å»ºã€‘

```bash
## viteæ„å»ºvueé¡¹ç›®
# npm 7+, extra double-dash is needed:
npm create vite@latest my-vue-app -- --template vue

# yarn
yarn create vite my-vue-app --template vue

# pnpm
pnpm create vite my-vue-app --template vue

# bun
bunx create-vite my-vue-app --template vue
```

æŸ¥çœ‹ [create-vite](https://github.com/vitejs/vite/tree/main/packages/create-vite) ä»¥è·å–æ¯ä¸ªæ¨¡æ¿çš„æ›´å¤šç»†èŠ‚ï¼š**vanillaï¼Œvanilla-ts, vue, vue-tsï¼Œreactï¼Œreact-tsï¼Œreact-swcï¼Œreact-swc-tsï¼Œpreactï¼Œpreact-tsï¼Œlitï¼Œlit-tsï¼Œsvelteï¼Œsvelte-tsï¼Œsolidï¼Œsolid-tsï¼Œqwikï¼Œqwik-ts**ã€‚

# 2.Vue3 è¯­æ³•æ ¸å¿ƒ

## 2.1 ã€æ‹‰å¼€åºå¹•çš„ setupã€‘

setup æ˜¯ Vue3 ä¸­çš„ä¸€ä¸ªæ–°é…ç½®é¡¹ï¼Œå€¼æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ˜¯ Composition API "è¡¨æ¼”çš„èˆå°"ï¼Œç»„ä»¶ä¸­æ‰€ç”¨åˆ°çš„ï¼šæ•°æ®ã€æ–¹æ³•ã€è®¡ç®—å±æ€§ã€ç›‘è§†â€¦â€¦ç­‰ï¼Œå‡é…ç½®åœ¨ setup å½“ä¸­ã€‚

**ç‰¹ç‚¹å¦‚ä¸‹**

- setup å‡½æ•°è¿”å›çš„å¯¹è±¡ä¸­çš„å†…å®¹ï¼Œå¯ç›´æ¥åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ã€‚
- setup ä¸­è®¿é—®çš„ this æ˜¯ undefinedã€‚
- setup å‡½æ•°ä¼šåœ¨ beforeCreate ä¹‹å‰è°ƒç”¨ï¼Œå®ƒæ˜¯â€œé¢†å…ˆâ€æ‰€æœ‰é’©å­æ‰§è¡Œçš„ã€‚

**setup çš„è¿”å›å€¼**

```js
//è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ï¼ï¼
return {
  name,
  age,
  tel,
  changeName,
  changeAge,
  showTel,
};

//ä¸€ä¸ªæ¸²æŸ“å‡½æ•°
return () => "å“ˆå“ˆ";
```

---

**æ¶‰åŠåˆ°çš„é¢è¯•é—®é¢˜**

1. ï¼ˆdataã€methodsâ€¦â€¦ï¼‰ å’Œ setup èƒ½ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼Ÿ
   **èƒ½ï¼Œå¯ä»¥åœ¨ä¸€ä¸ª Vue 3 ç»„ä»¶ä¸­åŒæ—¶ä½¿ç”¨ Options API å’Œ Composition APIã€‚ä½†æ˜¯ï¼Œå®ƒä»¬çš„ä½¿ç”¨åœºæ™¯æ˜¯ä¸åŒçš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœä½ æƒ³è¦å®šä¹‰ä¸€äº›åŸºç¡€çš„å“åº”å¼æ•°æ®å’Œé’©å­å‡½æ•°ï¼Œä½¿ç”¨ Options API å°±è¶³å¤Ÿäº†ã€‚è€Œå½“ä½ éœ€è¦æ›´å¤æ‚çš„é€»è¾‘æˆ–å¸Œæœ›æ›´å¥½åœ°ç»„ç»‡ä½ çš„ä»£ç æ—¶ï¼ŒComposition API ä¼šæ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ã€‚**
2. setup ä¸­å®šä¹‰çš„æ•°æ®ï¼Œåœ¨ data ä¸­èƒ½å¦è·å¾—ï¼Ÿ
   **èƒ½ï¼Œsetup è¿™ä¸ªé’©å­æ‰§è¡Œçš„æ—¶æœŸæ¯” data æ—©ï¼Œå½“ data ä¸­æ•°æ®è§£æå®Œæ¯•æ—¶ï¼Œsetup ä¸­æ•°æ®æ—©å·²ç»è§£æå®Œæ¯•äº†ï¼ï¼ï¼ä½†æ˜¯æ³¨æ„çš„æ˜¯ setup ä¸èƒ½å†å»è¯»å– data ä¸­çš„æ•°æ®äº†**

   ***

   **å®˜ç½‘çš„ setup è¯­æ³•ç³–**
   `<script setup>` æ˜¯åœ¨å•æ–‡ä»¶ç»„ä»¶ (SFC) ä¸­ä½¿ç”¨ç»„åˆå¼ API çš„ç¼–è¯‘æ—¶è¯­æ³•ç³–ã€‚å½“åŒæ—¶ä½¿ç”¨ SFC ä¸ç»„åˆå¼ API æ—¶è¯¥è¯­æ³•æ˜¯é»˜è®¤æ¨èã€‚ç›¸æ¯”äºæ™®é€šçš„ `<script>` è¯­æ³•ï¼Œå®ƒå…·æœ‰æ›´å¤šä¼˜åŠ¿ï¼š

- æ›´å°‘çš„æ ·æ¿å†…å®¹ï¼Œæ›´ç®€æ´çš„ä»£ç ã€‚
- èƒ½å¤Ÿä½¿ç”¨çº¯ TypeScript å£°æ˜ props å’Œè‡ªå®šä¹‰äº‹ä»¶ã€‚
- æ›´å¥½çš„è¿è¡Œæ—¶æ€§èƒ½ (å…¶æ¨¡æ¿ä¼šè¢«ç¼–è¯‘æˆåŒä¸€ä½œç”¨åŸŸå†…çš„æ¸²æŸ“å‡½æ•°ï¼Œé¿å…äº†æ¸²æŸ“ä¸Šä¸‹æ–‡ä»£ç†å¯¹è±¡)ã€‚
- æ›´å¥½çš„ IDE ç±»å‹æ¨å¯¼æ€§èƒ½ (å‡å°‘äº†è¯­è¨€æœåŠ¡å™¨ä»ä»£ç ä¸­æŠ½å–ç±»å‹çš„å·¥ä½œ)ã€‚

è¦å¯ç”¨è¯¥è¯­æ³•ï¼Œéœ€è¦åœ¨ `<script>` ä»£ç å—ä¸Šæ·»åŠ  setup attributeï¼š

```js
<script setup>console.log('hello script setup')</script>
```

**é‡Œé¢çš„ä»£ç ä¼šè¢«ç¼–è¯‘æˆç»„ä»¶ setup() å‡½æ•°çš„å†…å®¹**ã€‚è¿™æ„å‘³ç€ä¸æ™®é€šçš„ `<script>` åªåœ¨ç»„ä»¶è¢«é¦–æ¬¡å¼•å…¥çš„æ—¶å€™æ‰§è¡Œä¸€æ¬¡ä¸åŒï¼Œ**`<script setup>` ä¸­çš„ä»£ç ä¼šåœ¨æ¯æ¬¡ç»„ä»¶å®ä¾‹è¢«åˆ›å»ºçš„æ—¶å€™æ‰§è¡Œ**ã€‚

**Vue3 é¡¹ç›®æ³¨æ„ç‚¹**
Vue3 ä¸­å¯èƒ½ä¼šé‡åˆ°ä¸¤ä¸ª script æ ‡ç­¾ï¼Œä¸€ä¸ªæ˜¯ç”¨æ¥é…ç½®ç»„ä»¶åç§°çš„ï¼Œå¦ä¸€ä¸ªæ˜¯ç”¨æ¥é…ç½® setup çš„ã€‚

```js
<script lang="ts">
    export default {
        name:"Person123"
    }
</script>

<script lang="ts" setup>
  ...
</script>
```

å’Œä¸Šé¢è¿™æ ·å†™å¯èƒ½æœ‰ç‚¹éº»çƒ¦äº†ï¼æˆ‘ä»¬å¯ä»¥è¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š

1. æˆ‘ä»¬å¯ä»¥å€ŸåŠ©ä¸€ä¸ªæ’ä»¶

```sh
npm i vite-plugin-vue-setup-extend -D
```

2. åœ¨ `vite.config.ts` ä¸­è¿›è¡Œé…ç½®

```js
import { fileURLToPath, URL } from "node:url";

import { defineConfig } from "vite";
import vue from "@vitejs/plugin-vue";
import VueSetupExtend from "vite-plugin-vue-setup-extend";

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [vue(), VueSetupExtend()],
  resolve: {
    alias: {
      "@": fileURLToPath(new URL("./src", import.meta.url)),
    },
  },
});
```

3. åœ¨ script æ ‡ç­¾ä¸Šä½¿ç”¨

```js
<script lang="ts" setup name="Person456">
  ...
</script>
```

## 2.2 ref å’Œ reactive çš„å­¦ä¹ 

ref ==============> å¯ä»¥å®šä¹‰ï¼šåŸºæœ¬ç±»å‹ã€å¯¹è±¡ç±»å‹çš„å“åº”å¼æ•°æ®
reactive ===========> åªèƒ½å®šä¹‰ï¼šå¯¹è±¡ç±»å‹æ˜¯å“åº”å¼æ•°æ®

**ref å¯¹æ¯” reactive**
å®è§‚è§’åº¦ï¼š

> 1. ref ç”¨æ¥å®šä¹‰ï¼šåŸºæœ¬æ•°æ®ç±»å‹ã€å¯¹è±¡æ•°æ®ç±»å‹
> 2. reactive ç”¨æ¥å®šä¹‰ï¼šå¯¹è±¡æ•°æ®ç±»å‹

åŒºåˆ«ï¼š

> 1. ref åˆ›å»ºçš„å˜é‡å¿…é¡»ä½¿ç”¨ .value (å¯ä»¥ä½¿ç”¨ volar æ’ä»¶è‡ªåŠ¨æ·»åŠ  .value)
> 2. reactive é‡æ–°åˆ†é…ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä¼šå¤±å»å“åº”å¼ ï¼ˆå¯ä»¥ä½¿ç”¨ Object.assign å»æ•´ä½“æ›¿æ¢ï¼‰

ä½¿ç”¨åŸåˆ™ï¼š

> 1. è‹¥éœ€è¦ä¸€ä¸ªåŸºæœ¬ç±»å‹çš„å“åº”å¼æ•°æ®ï¼Œå¿…é¡»ä½¿ç”¨ ref
> 2. è‹¥éœ€è¦ä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼Œå±‚çº§ä¸æ·±ï¼Œrefã€reactive éƒ½å¯ä»¥
> 3. è‹¥éœ€è¦ä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼Œä¸”å±‚çº§è¾ƒæ·±ï¼Œæ¨èä½¿ç”¨ reactive

**reactiveä¸­ä¸€ä¸ªæ³¨æ„ç‚¹ï¼šï¼ˆè‡ªåŠ¨è§£åŒ…ï¼‰**
```js
//å½“è®¿é—® obj.c çš„æ—¶å€™ï¼Œåº•å±‚ä¼šè‡ªåŠ¨è¯»å–valueå±æ€§ï¼Œå› ä¸ºcæ˜¯åœ¨objè¿™ä¸ªå“åº”å¼å¯¹è±¡é‡Œï¼ï¼ï¼
let obj=reactive({
  a:1,
  b:2,
  c:ref(3)
})
```

## 2.3 toRefsã€toRefã€computed

**toRefs å’Œ toRef çš„ä½œç”¨**

> å°†ä¸€ä¸ªå“åº”å¼å¯¹è±¡çš„æ¯ä¸ªå±æ€§ï¼Œè½¬æ¢æˆä¸ºä¸€ä¸ª ref å¯¹è±¡ã€‚ä¸¤ä¸ªåŸºæœ¬ç›¸ä¼¼ï¼Œä½†æ˜¯ toRefs å¯ä»¥æ‰¹é‡è½¬æ¢ï¼

```js
    import {reactive,toRefs,toRef} from "vue"
    //æ•°æ®
    let person=reactive({
        name:"xiaoyu",
        age:18
    })
    // let {name,age}=person;
    // console.log(name,age);//äº§ç”Ÿå‡ºæ™®é€šçš„å€¼ï¼

    let {name,age}=toRefs(person);
    console.log(name,age);

    let name2=toRef(person,"name");
    console.log(name2);

    //åƒå¦‚ä¸‹è¿™ç§
    ObjectRefImplÂ {_object: Proxy(Object), _key: 'name', _defaultValue: undefined, __v_isRef: true}__v_isRef: true_defaultValue: undefined_key: "name"_object: Proxy(Object)Â {name: 'xiaoyu', age: 18}dep: (...)value: (...)[[Prototype]]: Object
```

## 2.4 ã€watchã€‘

- ä½œç”¨ï¼šç›‘è§†æ•°æ®çš„å˜åŒ–ï¼ˆå’Œ Vue2 ä¸­çš„ watch ä¸€è‡´ï¼‰
- ç‰¹ç‚¹ï¼šVue3 çš„ watch åªèƒ½ç›‘è§†ä»¥ä¸‹å››ç§æ•°æ®ï¼š
  > 1. ref å®šä¹‰çš„æ•°æ®
  > 2. reactive å®šä¹‰çš„æ•°æ®
  > 3. å‡½æ•°è¿”å›ä¸€ä¸ªå€¼ï¼ˆgetter å‡½æ•°ï¼‰
  > 4. ä¸€ä¸ªåŒ…å«ä¸Šè¿°å†…å®¹çš„æ•°ç»„

### \*æƒ…å†µä¸€ï¼šç›‘è§†ã€refã€‘å®šä¹‰çš„ ã€åŸºæœ¬ç±»å‹ã€‘æ•°æ®

```js
// æƒ…å†µä¸€ï¼šç›‘è§†ã€refã€‘å®šä¹‰çš„ ã€åŸºæœ¬ç±»å‹ã€‘æ•°æ®
let sum = ref(0);
const stopWatch = watch(sum, (newVal, oldVal) => {
  console.log(newVal, oldVal);
  //è¿™ä¸ªwatchè¿˜è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨å®ƒå¯ä»¥è§£é™¤ç›‘è§†ï¼ï¼ï¼
  if (newVal > 10) {
    stopWatch();
  }
});
console.log(stopWatch); //è¿”å›ä¸€ä¸ªå‡½æ•°
/* 
    () => {
    effect2.stop();
    if (instance && instance.scope) {
      remove(instance.scope.effects, effect2);
    }
  }
    */
```

### \*æƒ…å†µäºŒï¼šç›‘è§†ã€refã€‘å®šä¹‰çš„ ã€å¯¹è±¡ç±»å‹ã€‘æ•°æ®

ç›‘è§†ã€refã€‘å®šä¹‰çš„ ã€å¯¹è±¡ç±»å‹ã€‘æ•°æ®:ç›´æ¥å†™æ•°æ®åï¼Œç›‘è§†çš„æ˜¯å¯¹è±¡çš„åœ°å€å€¼ï¼Œè‹¥æƒ³ç›‘è§†å¯¹è±¡å†…éƒ¨çš„å±æ€§å˜åŒ–ï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯æ·±åº¦ç›‘è§†ã€‚

> æ³¨æ„
>
> - è‹¥ä¿®æ”¹çš„æ˜¯ ref å®šä¹‰çš„å¯¹è±¡ä¸­çš„å±æ€§ï¼ŒnewVal å’Œ oldVal éƒ½æ˜¯æ–°å€¼ï¼Œå› ä¸ºä»–ä»¬æ˜¯åŒä¸€ä¸ªå¯¹è±¡
> - è‹¥ä¿®æ”¹æ•´ä¸ª ref å®šä¹‰çš„å¯¹è±¡ï¼ŒnewVal æ˜¯æ–°å€¼ï¼ŒoldVal æ˜¯æ—§å€¼ï¼Œå› ä¸ºä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡äº†ã€‚

```js
let person = ref({
  name: "å¼ ä¸‰",
  age: 18,
});
const changeName = () => {
  person.value.name += "~";
};
const changeAge = () => {
  person.value.age += 1;
};
const changePerson = () => {
  person.value = { name: "ææ˜", age: 20 };
};
//ç›‘è§†ã€refã€‘å®šä¹‰çš„ ã€å¯¹è±¡ç±»å‹ã€‘æ•°æ®ï¼Œç›‘è§†çš„æ˜¯å¯¹è±¡çš„åœ°å€å€¼ï¼Œ
// è‹¥æƒ³ç›‘è§†å¯¹è±¡å†…éƒ¨çš„å±æ€§å˜åŒ–ï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯æ·±åº¦ç›‘è§†ã€‚
watch(
  person,
  (newVal, oldVal) => {
    console.log(newVal, oldVal);
  },
  { deep: true }
);
```

### \*æƒ…å†µä¸‰ï¼šç›‘è§† ã€reactiveã€‘å®šä¹‰çš„ã€å¯¹è±¡ç±»å‹ã€‘æ•°æ®ï¼Œä¸”é»˜è®¤å¼€å¯äº†æ·±åº¦ç›‘è§†

```js
let p = reactive({
  name: "å°é›¨",
  age: 20,
});
const pName = () => {
  p.name += "~";
};
const pAge = () => {
  p.age += 1;
};
const pPerson = () => {
  //è¿™é‡Œä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ä¿®æ”¹æ•´ä¸ªäººï¼Œè€Œæ˜¯è¿›è¡Œäº†æ‰¹é‡çš„ä¿®æ”¹ï¼ï¼ï¼
  Object.assign(p, { name: "å°æŸ”", age: 19 });
};

//ç›‘è§†ã€reactiveã€‘å®šä¹‰çš„ ã€å¯¹è±¡ç±»å‹ã€‘æ•°æ®,é»˜è®¤å¼€å¯äº†æ·±åº¦ç›‘è§†!!!
watch(p, (newVal, oldVal) => {
  console.log(newVal, oldVal);
});
```

### \*æƒ…å†µå››ï¼šç›‘è§† ref æˆ– reactive å®šä¹‰çš„ã€å¯¹è±¡ç±»å‹ã€‘æ•°æ®ä¸­çš„ æŸä¸ªå±æ€§

**æ³¨æ„ç‚¹ï¼š**

1. è‹¥è¯¥å±æ€§å€¼ä¸æ˜¯ã€å¯¹è±¡ç±»å‹ã€‘ï¼Œéœ€è¦å†™æˆå‡½æ•°å½¢å¼
2. è‹¥è¯¥å±æ€§å€¼ä¾ç„¶æ˜¯ã€å¯¹è±¡ç±»å‹ã€‘ï¼Œå¯ä»¥ç›´æ¥ç¼–ï¼Œä¹Ÿå¯ä»¥å†™æˆå‡½æ•°ï¼Œè¿˜æ˜¯å»ºè®®å†™æˆå‡½æ•°ï¼

**ç»“è®ºï¼šç›‘è§†çš„è¦æ˜¯å¯¹è±¡é‡Œé¢çš„å±æ€§ï¼Œé‚£ä¹ˆæœ€å¥½å†™å‡½æ•°å¼ã€‚æ³¨æ„ç‚¹ï¼šè‹¥æ˜¯å¯¹è±¡ç›‘è§†çš„æ˜¯åœ°å€å€¼ï¼Œéœ€è¦å…³æ³¨å¯¹è±¡å†…éƒ¨ï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯æ·±åº¦ç›‘è§†ï¼**

```js
let p2 = reactive({
  name: "xiaoyu",
  age: 18,
  car: {
    c1: "å¥”é©°",
    c2: "å®é©¬",
  },
});
const p2Car = () => {
  p2.car = { c1: "å¤§å¥”é©°", c2: "å¤§å®é©¬" };
};
//æƒ…å†µå››ï¼šç›‘è§†å“åº”å¼å¯¹è±¡ä¸­çš„æŸä¸ªå±æ€§ï¼Œä¸”è¯¥å±æ€§æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œè¦å†™æˆå‡½æ•°å¼ã€‚
watch(
  () => p2.name,
  (newVal, oldVal) => {
    console.log(newVal, oldVal);
  }
);
//ä¸‹é¢è¿™ä¸ªæƒ…å†µå°±å¾ˆè¯¡å¼‚ï¼Œèƒ½ç›‘è§†åˆ°å¯¹è±¡é‡Œé¢çš„å€¼å˜åŒ–ï¼Œå¯¹è±¡æœ¬èº«å´ä¸è¿›è¡Œç›‘è§†ï¼
// watch(p2.car,(newVal,oldVal)=>{
//     console.log(newVal,oldVal);
// })

//å»ºè®®å†™æˆç›‘è§†å…¶ä¸­çš„å±æ€§ä»»ç„¶æ˜¯ä¸€ä¸ªå¯¹è±¡ç±»å‹çš„ï¼Œä¹Ÿæ¨èä½¿ç”¨å‡½æ•°å½¢å¼çš„ï¼
watch(
  () => p2.car,
  (newVal, oldVal) => {
    console.log(newVal, oldVal);
  },
  { deep: true }
);
```

### \*æƒ…å†µäº”ï¼šç›‘è§†å¤šä¸ªæ•°æ®

```js
// æƒ…å†µäº”ï¼šç›‘è§†å¤šä¸ªæ•°æ®ï¼š
watch([() => p2.name, () => p2.car.c1], (newVal, oldVal) => {
  console.log(newVal, oldVal);
});
```

## 2.5ã€watchEffectã€‘

- å®˜ç½‘ï¼šç«‹å³è¿è¡Œä¸€ä¸ªå‡½æ•°ï¼ŒåŒæ—¶å“åº”å¼çš„è·Ÿè¸ªå™¨ä¾èµ–ï¼Œå¹¶åœ¨ä¾èµ–æ›´æ–°æ—¶é‡æ–°æ‰§è¡Œè¯¥å‡½æ•°ã€‚
- watch å¯¹æ¯” watchEffect
  > 1. éƒ½èƒ½ç›‘è§†å“åº”å¼æ•°æ®çš„å˜åŒ–ï¼Œä¸åŒçš„æ˜¯ç›‘å¬æ•°æ®å˜åŒ–çš„æ–¹å¼ä¸åŒ
  > 2. watchï¼šéœ€è¦æŒ‡æ˜å‡ºç›‘è§†çš„æ•°æ®
  > 3. watchEffectï¼šä¸ç”¨æ˜ç¡®æŒ‡å‡ºç›‘å¬çš„æ•°æ®ï¼ˆå‡½æ•°ä¸­ç”¨åˆ°äº†é‚£äº›å±æ€§ï¼Œé‚£å°±æ˜¯ç›‘è§†é‚£äº›å±æ€§ï¼ï¼‰

## 2.6ã€æ ‡ç­¾çš„ ref å±æ€§ã€‘

ä½œç”¨ï¼šç”¨äºæ³¨å†Œæ¨¡æ¿å¼•ç”¨

> - ç”¨äºæ™®é€š DOM æ ‡ç­¾ä¸Šï¼Œè·å–çš„æ˜¯ DOM èŠ‚ç‚¹
> - ç”¨äºç»„ä»¶æ ‡ç­¾ä¸Šï¼Œè·å–çš„æ˜¯ç»„ä»¶å®ä¾‹å¯¹è±¡

**è¿™é‡Œæœ‰ä¸ªè¯´æ³•ï¼šåœ¨è·å–ç»„ä»¶å®ä¾‹å®ä¾‹èº«ä¸Šçš„ä¸œè¥¿æ—¶ï¼Œvue3 ä¸å…è®¸ç›´æ¥è·å–ï¼Œè¦æ±‚è·å–ç»„ä»¶çš„æœ¬èº«ä¸»åŠ¨æš´éœ²å‡ºæ¥å±æ€§æ‰è¡Œï¼ï¼ï¼å¦‚ defineExpose({a,b,c})**
å¯¹äºå­ç»„ä»¶ Person ä¸­å¦‚ä¸‹ï¼š

```js
<template>
    <div class="person">
        <h1>ä¸­å›½</h1>
        <h2 ref="title">åŒ—äº¬</h2>
        <button @click="showLog">ç‚¹å‡»è¾“å‡ºh2è¿™ä¸ªå…ƒç´ </button>
    </div>
</template>

<script lang="ts" setup name="Person">
    import {ref,defineExpose} from "vue"
    let title=ref()

    let a=ref(0)
    let b=ref(1)
    let c=ref(2)
    const showLog=()=>{
      console.log(title.value);//è·å–çš„æ˜¯DOM
    }

    defineExpose({a,b,c})
</script>
```

çˆ¶ç»„ä»¶ä¸­å¦‚ä¸‹ï¼š

```js
<script setup lang="ts" name="App">
    import Person from './components/Person.vue';
    import {ref} from "vue"

    let title=ref()
    let ren=ref()
    const showLog=()=>{
        console.log(title.value);//è·å–DOM
        console.log(ren.value);//ç»„ä»·å®ä¾‹

    }
</script>

<template>
    <h2 ref="title">ä½ å¥½</h2>
    <button @click="showLog">ç‚¹æˆ‘è¾“å‡ºh2</button>
    <Person ref="ren"/>
</template>
```

## 2.7 props

**App.vue**

```html
<script setup lang="ts" name="App">
  import Person from "./components/Person.vue";
  import type { PersonInter, Persons } from "@/types/index";
  import { reactive, ref } from "vue";

  let person: PersonInter = { id: "sgbusjdbsj", name: "xiaoyu", age: 20 };

  let personList = reactive<Persons>([
    { id: "sgbusjdbsjas", name: "xiaoyu", age: 18 },
    { id: "sgbusjdbsjsf", name: "xiaohh", age: 20 },
    { id: "sgbusjdbsjdf", name: "xiaogege", age: 10 },
  ]);
</script>

<template>
  <Person a="å“ˆå“ˆ" b="å˜¿å˜¿" :list="personList" />
</template>
```

**Person.vue**

```html
<template>
  <div class="person">
    <h2>{{ list }}</h2>
  </div>
</template>

<script lang="ts" setup name="Person">
  //å…¶å®è¿™é‡Œçš„ å®å‡½æ•° æ— éœ€å¼•å…¥å°±èƒ½è¿›è¡Œä½¿ç”¨ï¼ï¼ï¼
  import { defineProps, withDefaults } from "vue";
  import type { Persons } from "@/types/index";

  //æ¥æ”¶propsï¼Œé¡ºä¾¿ä½¿ç”¨ï¼
  // let x=defineProps(['a','b',"list"])
  // console.log(x);

  //æ¥æ”¶list + é™åˆ¶ç±»å‹
  // defineProps<{list:Persons}>()

  //æ¥æ”¶list + ç±»å‹é™åˆ¶ + é™åˆ¶å¿…è¦æ€§ + æŒ‡å®šé»˜è®¤å€¼
  withDefaults(defineProps<{ list?: Persons }>(), {
    list: () => [{ id: "1", name: "xiao", age: 19 }],
  });
</script>
```

## 2.8 Hooks

**æ³¨æ„æ¨¡å—åŒ–çš„ç”¨æ³•å°±è¡Œäº†ï¼ï¼ï¼**

```ts
// mouse.ts
import { ref, onMounted, onUnmounted } from "vue";

// æŒ‰ç…§æƒ¯ä¾‹ï¼Œç»„åˆå¼å‡½æ•°åä»¥â€œuseâ€å¼€å¤´
export function useMouse() {
  // è¢«ç»„åˆå¼å‡½æ•°å°è£…å’Œç®¡ç†çš„çŠ¶æ€
  const x = ref(0);
  const y = ref(0);

  // ç»„åˆå¼å‡½æ•°å¯ä»¥éšæ—¶æ›´æ”¹å…¶çŠ¶æ€ã€‚
  function update(event: any) {
    x.value = event.pageX;
    y.value = event.pageY;
  }

  // ä¸€ä¸ªç»„åˆå¼å‡½æ•°ä¹Ÿå¯ä»¥æŒ‚é åœ¨æ‰€å±ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¸Š
  // æ¥å¯åŠ¨å’Œå¸è½½å‰¯ä½œç”¨
  onMounted(() => window.addEventListener("mousemove", update));
  onUnmounted(() => window.removeEventListener("mousemove", update));

  // é€šè¿‡è¿”å›å€¼æš´éœ²æ‰€ç®¡ç†çš„çŠ¶æ€
  return { x, y };
}
```

```html
<template>
  <div class="person">Mouse position is at: {{ x }}, {{ y }}</div>
</template>

<script lang="ts" setup name="Person">
  import { useMouse } from "@/hooks/mouse";

  const { x, y } = useMouse();
</script>
```

# 3.è·¯ç”±

```html
<router-link ></router-link>
<RouterLink></RouterLink>
```

## 3.1 ä¸¤ä¸ªæ³¨æ„ç‚¹

> 1. è·¯ç”±ç»„ä»¶é€šå¸¸å­˜æ”¾åœ¨ pages æˆ–è€… views æ–‡ä»¶å¤¹ä¸­ï¼Œä¸€èˆ¬ç»„ä»¶é€šå¸¸å­˜æ”¾åœ¨ components æ–‡ä»¶å¤¹ã€‚
> 2. é€šè¿‡ç‚¹å‡»å¯¼èˆªï¼Œè§†è§‰æ•ˆæœä¸Šâ€œæ¶ˆå¤±äº†â€çš„è·¯ç”±ç»„ä»¶ï¼Œé»˜è®¤æ˜¯è¢«é”€æ¯æ‰çš„ï¼Œéœ€è¦çš„æ—¶å€™å†å»æŒ‚è½½ã€‚

## 3.2 RouterLink ä¸­ to çš„ä¸¤ç§å†™æ³•

**active-class æ˜¯ RouterLinkPropsï¼šé“¾æ¥åœ¨åŒ¹é…å½“å‰è·¯ç”±æ—¶è¢«åº”ç”¨åˆ° classã€‚**

```html
<!-- ç¬¬ä¸€ç§ï¼štoçš„å­—ç¬¦ä¸²å†™æ³• -->
<RouterLink active-class="active" to="/home">ä¸»é¡µ</RouterLink>

<!-- ç¬¬äºŒç§ï¼štoçš„å¯¹è±¡å†™æ³• -->
<RouterLink active-class="active" :to="{path:"/home"}">ä¸»é¡µ</RouterLink>
```

## 3.3 è·¯ç”±å™¨çš„å·¥ä½œæ¨¡å¼

1. **history æ¨¡å¼**

   > ä¼˜ç‚¹ï¼šURL æ›´åŠ ç¾è§‚ï¼Œä¸å¸¦æœ‰#ï¼Œæ›´æ¥è¿‘äºä¼ ç»Ÿçš„ç½‘ç«™ URLã€‚
   > ç¼ºç‚¹ï¼šåæœŸé¡¹ç›®ä¸Šçº¿ï¼Œéœ€è¦æœåŠ¡ç«¯é…åˆå¤„ç†è·¯å¾„é—®é¢˜ï¼Œå¦åˆ™åˆ·æ–°ä¼šæœ‰ 404 çš„é”™è¯¯ã€‚
   >
   > ```js
   > const router = createRouter({
   >   history: createWebHistory(),
   > });
   > ```

2. **hash æ¨¡å¼(åå°ç®¡ç†ç³»ç»Ÿå–œæ¬¢ç”¨ï¼ï¼ï¼)**
   > ä¼˜ç‚¹ï¼šå…¼å®¹æ€§æ›´å¥½ï¼Œå› ä¸ºä¸éœ€è¦æœåŠ¡ç«¯å¤„ç†è·¯å¾„ã€‚
   > ç¼ºç‚¹ï¼šURl å¸¦æœ‰#ä¸å¤ªç¾è§‚ï¼Œä¸”åœ¨ SEO ä¼˜åŒ–æ–¹é¢ç›¸å¯¹è¾ƒå·®ã€‚
   >
   > ```js
   > const router = createRouter({
   >   history: createWebHashHistory(),
   > });
   > ```

## 3.4 è·¯ç”±ä¼ å‚
### query ä¼ å‚
**ä¼ å‚**
```html
<!-- ç¬¬ä¸€ç§å†™æ³• -->
<RouterLink :to="`/news/detail?id=${news.id}&title=${news.title}&content=${news.content}`">ä¸»é¡µ</RouterLink>

<!-- ç¬¬äºŒç§å†™æ³• -->
<!-- ç”¨ name é…åˆ query ä¹Ÿå¯ä»¥è¿›è¡Œè·³è½¬ ï¼ï¼ï¼-->
<RouterLink :to="{path:"/news/detail",query:{id:news.id,title:news.title,content:news.content}}">ä¸»é¡µ</RouterLink>
```

**æ¥æ”¶å‚æ•°**
```js
import {useRoute} from "vue-router"
const route=useRoute()
//æ‰“å°queryå‚æ•°
console.log(route.query)
```

### parmas ä¼ å‚
è·¯ç”±å ä½ï¼š
```js
{
  name:'xinwen',
  path:'/news',
  component:Detail,
  children:[
    {
      name:'xiangqing',
      path:'detail/:id/:title/:content?',
      //åœ¨å ä½åé¢åŠ ä¸€ä¸ª ? è¡¨ç¤ºå‚æ•°å¯ä¼ å¯ä¸ä¼ 
      component:Detail
    }
  ]
}
```
è·¯ç”±ä¼ å‚ï¼š
```html
<!-- ç¬¬ä¸€ç§å†™æ³• -->
<RouterLink :to="`/news/detail/${news.id}/${news.title}/${news.content}`">ä¸»é¡µ</RouterLink>

<!-- ç¬¬äºŒç§å†™æ³• -->
<!-- æ³¨æ„ï¼šä½¿ç”¨paramsä¼ å‚ åªèƒ½é…åˆnameè¿›è¡Œï¼Œä¸è¦æ˜¯path -->
<RouterLink :to="{name:"xiangqing",params:{id:news.id,title:news.title,content:news.content}}">ä¸»é¡µ</RouterLink>
<!-- è¿˜æœ‰paramsæ˜¯ä¸èƒ½ä¼ æ•°ç»„çš„ï¼ä¸€ä¸ªä¸è¢«æ¨èçš„æ•°æ®ç±»å‹ -->
```
æ³¨æ„ï¼š
> 1. ä¼ é€’paramså‚æ•°æ—¶ï¼Œè‹¥ä½¿ç”¨toçš„å¯¹è±¡å†™æ³•ï¼Œå¿…é¡»ä½¿ç”¨nameé…ç½®é¡¹ï¼Œä¸èƒ½ä½¿ç”¨pathã€‚
> 2. ä¼ é€’paramså‚æ•°æ—¶ï¼Œéœ€è¦æå‰åœ¨è§„åˆ™ä¸­å ä½ï¼

## 3.5 è·¯ç”±çš„Propsé…ç½®
**ç¬¬ä¸€ç§å†™æ³•ï¼šå°†è·¯ç”±æ”¶åˆ°çš„æ‰€æœ‰paramså‚æ•°ä½œä¸ºpropsä¼ é€’ç»™ç»„ä»¶ã€‚**
```js
{
  name:'xinwen',
  path:'/news',
  component:Detail,
  children:[
    {
      name:'xiangqing',
      path:'detail/:id/:title/:content?',//åœ¨å ä½åé¢åŠ ä¸€ä¸ª ? è¡¨ç¤ºå‚æ•°å¯ä¼ å¯ä¸ä¼ 
      component:Detail,
      //ç¬¬ä¸€ç§å†™æ³•ï¼šå°†è·¯ç”±æ”¶åˆ°çš„æ‰€æœ‰paramså‚æ•°ä½œä¸ºpropsä¼ é€’ç»™ç»„ä»¶ã€‚
      props:true
    }
  ]
}
```
**ç¬¬äºŒç§å†™æ³•ï¼šå¯ä»¥è‡ªå·±å†³å®šå°†ä»€ä¹ˆä½œä¸ºpropsä¼ ç»™è·¯ç”±ç»„ä»¶**
```js
{
  name:'xinwen',
  path:'/news',
  component:Detail,
  children:[
    {
      name:'xiangqing',
      path:'detail',
      component:Detail,
      
      // ç¬¬äºŒç§å†™æ³•ï¼šå¯ä»¥è‡ªå·±å†³å®šå°†ä»€ä¹ˆä½œä¸ºpropsä¼ ç»™è·¯ç”±ç»„ä»¶
      props(route){
        return route.query
      }

      //ä¸€ç§å›ºå®šå€¼çš„å†™æ³•ï¼Œç”¨åˆ°çš„æ¯”è¾ƒå°‘ï¼ï¼ï¼ä¹Ÿæ˜¯å°†å‚æ•°ä¼ ç»™ç»„ä»¶èº«ä¸Šã€‚
      props:{
        a:'1',  
        b:'2'
      }
    }
  ]
}
```

## 3.6 ã€replaceå±æ€§ã€‘
1. ä½œç”¨ï¼šæ§åˆ¶è·¯ç”±è·³è½¬æ—¶æ“ä½œæµè§ˆå™¨å†å²è®°å½•çš„æ¨¡å¼
2. æµè§ˆå™¨çš„å†å²è®°å½•æœ‰ä¸¤ç§å†™å…¥æ–¹å¼ï¼šåˆ†åˆ«ä¸ºpushã€replaceï¼š
   - push æ˜¯è¿½åŠ å†å²è®°å½•ï¼ˆé»˜è®¤ï¼‰
   - replace æ˜¯æ›¿æ¢å½“å‰è®°å½•
3. å¼€å¯replaceæ¨¡å¼ï¼š
```html
<RouterLink replace >ä¸»é¡µ</RouterLink>
```

## 3.7 ã€ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª å’Œ é‡å®šå‘ã€‘
**ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª**
```js
import {  useRouter } from "vue-router"
let router=useRouter()
router.push(
  //è¿™é‡Œå’Œ router-link ä¸­çš„ to ä¸€ä¸ªæ ·ï¼ï¼ï¼
)
```

**é‡å®šå‘**
```js
//åœ¨è·¯ç”±è§„åˆ™ä¸­
{
  path:'/',
  redirect:"/home"
}
```

# 4.ã€piniaã€‘ï¼ˆå»ºè®®çœ‹å®˜ç½‘ï¼‰
> Pinia
> ç¬¦åˆç›´è§‰çš„
> Vue.js çŠ¶æ€ç®¡ç†åº“

[Piniaå®˜ç½‘](https://pinia.vuejs.org/zh/)

## 4.1 åœ¨Vue3é¡¹ç›®ä¸­å¼•å…¥pinia
**å®‰è£…**
```bash
yarn add pinia
# æˆ–è€…ä½¿ç”¨ npm
npm install pinia
```
**åœ¨ main.tsä¸­å¼•å…¥**
```js
import { createApp } from 'vue'
import { createPinia } from 'pinia'
import App from './App.vue'

const pinia = createPinia()
const app = createApp(App)

app.use(pinia)
app.mount('#app')
```

## 4.2 å®˜ç½‘çš„ä¸€ä¸ªåŸºç¡€ç¤ºä¾‹
**å…ˆåˆ›å»ºä¸€ä¸ª Store(é€‰é¡¹å¼)**
```js
// stores/counter.js
import { defineStore } from 'pinia'

export const useCounterStore = defineStore('counter', {
  state: () => {
    return { count: 0 }
  },
  // ä¹Ÿå¯ä»¥è¿™æ ·å®šä¹‰
  // state: () => ({ count: 0 })
  actions: {
    increment() {
      this.count++
    },
  },
})
```
**åœ¨ä¸€ä¸ªç»„ä»¶ä¸­ä½¿ç”¨è¯¥ store**
```html
<script setup>
import { useCounterStore } from '@/stores/counter'
//è¿™ä¸‹é¢ä¸‰ç§æ–¹å¼ç”¨æ¥æ›´æ”¹çŠ¶æ€ï¼ï¼ï¼
const counter = useCounterStore()
//å¸¸è§„æ›´æ”¹ï¼
counter.count++
// è‡ªåŠ¨è¡¥å…¨ï¼ âœ¨
counter.$patch({ count: counter.count + 1 })
// æˆ–ä½¿ç”¨ action ä»£æ›¿
counter.increment()
</script>
<template>
  <!-- ç›´æ¥ä» store ä¸­è®¿é—® state -->
  <div>Current Count: {{ counter.count }}</div>
</template>
```
**ä¸€ä¸ªç‰¹æ®Šçš„å®šä¹‰Storeçš„æ–¹å¼(ç»„åˆå¼)**
ä¸ºå®ç°æ›´å¤šé«˜çº§ç”¨æ³•ï¼Œä½ ç”šè‡³å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•° (ä¸ç»„ä»¶ setup() ç±»ä¼¼) æ¥å®šä¹‰ä¸€ä¸ª Store
```js
// stores/counter.js
export const useCounterStore = defineStore('counter', () => {
  const count = ref(0)
  function increment() {
    count.value++
  }

  return { count, increment }
})
```

## 4.3 ã€å®šä¹‰ä¸€ä¸ªStoreã€‘
æˆ‘ä»¬å¾—çŸ¥é“ Store æ˜¯ç”¨ defineStore() å®šä¹‰çš„ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°è¦æ±‚æ˜¯ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„åå­—ï¼š

```js
import { defineStore } from 'pinia'

// ä½ å¯ä»¥å¯¹ `defineStore()` çš„è¿”å›å€¼è¿›è¡Œä»»æ„å‘½åï¼Œä½†æœ€å¥½ä½¿ç”¨ store çš„åå­—ï¼ŒåŒæ—¶ä»¥ `use` å¼€å¤´ä¸”ä»¥ `Store` ç»“å°¾ã€‚(æ¯”å¦‚ `useUserStore`ï¼Œ`useCartStore`ï¼Œ`useProductStore`)
// ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä½ çš„åº”ç”¨ä¸­ Store çš„å”¯ä¸€ IDã€‚
export const useAlertsStore = defineStore('alerts', {
  // å…¶ä»–é…ç½®...
})
```
<strong>è¿™ä¸ªåå­— ï¼Œä¹Ÿè¢«ç”¨ä½œ id ï¼Œæ˜¯å¿…é¡»ä¼ å…¥çš„ï¼Œ Pinia å°†ç”¨å®ƒæ¥è¿æ¥ store å’Œ devtoolsã€‚</strong>ä¸ºäº†å…»æˆä¹ æƒ¯æ€§çš„ç”¨æ³•ï¼Œå°†è¿”å›çš„å‡½æ•°å‘½åä¸º **use...** æ˜¯ä¸€ä¸ªç¬¦åˆç»„åˆå¼å‡½æ•°é£æ ¼çš„çº¦å®šã€‚

defineStore() çš„ç¬¬äºŒä¸ªå‚æ•°å¯æ¥å—ä¸¤ç±»å€¼ï¼š**Setup å‡½æ•°æˆ– Option å¯¹è±¡**ã€‚

### ã€Option Storeã€‘
```js
export const useCounterStore = defineStore('counter', {
  state: () => ({ count: 0 }),
  getters: {
    double: (state) => state.count * 2,
  },
  actions: {
    increment() {
      this.count++
    },
  },
})
```

### ã€Setup Storeã€‘
åœ¨ Setup Store ä¸­ï¼š

- ref() å°±æ˜¯ state å±æ€§
- computed() å°±æ˜¯ getters
- function() å°±æ˜¯ actions
```js
export const useCounterStore = defineStore('counter', () => {
  const count = ref(0)
  function increment() {
    count.value++
  }

  return { count, increment }
})
```

## 4.4ã€ä½¿ç”¨ä¸€ä¸ªStoreã€‘
```html
<script setup>
import { storeToRefs } from 'pinia'
import { useCounterStore } from '@/stores/counter'
// å¯ä»¥åœ¨ç»„ä»¶ä¸­çš„ä»»æ„ä½ç½®è®¿é—® `store` å˜é‡ âœ¨
const store = useCounterStore()

// `name` å’Œ `doubleCount` æ˜¯å“åº”å¼çš„ ref
// åŒæ—¶é€šè¿‡æ’ä»¶æ·»åŠ çš„å±æ€§ä¹Ÿä¼šè¢«æå–ä¸º ref
// å¹¶ä¸”ä¼šè·³è¿‡æ‰€æœ‰çš„ action æˆ–éå“åº”å¼ (ä¸æ˜¯ ref æˆ– reactive) çš„å±æ€§
const { name, doubleCount } = storeToRefs(store)
// ä½œä¸º action çš„ increment å¯ä»¥ç›´æ¥è§£æ„
const { increment } = store
</script>
```

> ä¸ºäº†ä» store ä¸­æå–å±æ€§æ—¶ä¿æŒå…¶å“åº”æ€§ï¼Œä½ éœ€è¦ä½¿ç”¨ storeToRefs()
> ä½œä¸º action çš„ increment å¯ä»¥ç›´æ¥è§£æ„ï¼Œgetter å’Œ state éœ€è¦ä½¿ç”¨storeToRefs()

## 4.5 ã€Stateã€‘
### é‡ç½® state
ä½¿ç”¨**é€‰é¡¹å¼API** æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡è°ƒç”¨ store çš„ \$reset() æ–¹æ³•å°† state é‡ç½®ä¸ºåˆå§‹å€¼ã€‚
åœ¨ \$reset() å†…éƒ¨ï¼Œä¼šè°ƒç”¨ state() å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„çŠ¶æ€å¯¹è±¡ï¼Œå¹¶ç”¨å®ƒæ›¿æ¢å½“å‰çŠ¶æ€ã€‚
```js
const store = useStore()

store.$reset()
```

åœ¨ Setup Stores ä¸­ï¼Œæ‚¨éœ€è¦åˆ›å»ºè‡ªå·±çš„ \$reset() æ–¹æ³•ï¼š

```ts
export const useCounterStore = defineStore('counter', () => {
  const count = ref(0)

  function $reset() {
    count.value = 0
  }

  return { count, $reset }
})
```

### å˜æ›´ state
é™¤äº†ç”¨ store.count++ ç›´æ¥æ”¹å˜ storeï¼Œä½ è¿˜å¯ä»¥è°ƒç”¨ $patch æ–¹æ³•ã€‚å®ƒå…è®¸ä½ ç”¨ä¸€ä¸ª state çš„è¡¥ä¸å¯¹è±¡åœ¨åŒä¸€æ—¶é—´æ›´æ”¹å¤šä¸ªå±æ€§ï¼š
```js
store.$patch({
  count: store.count + 1,
  age: 120,
  name: 'DIO',
})
```
ä¸è¿‡ï¼Œç”¨è¿™ç§è¯­æ³•çš„è¯ï¼Œæœ‰äº›å˜æ›´çœŸçš„å¾ˆéš¾å®ç°æˆ–è€…å¾ˆè€—æ—¶ï¼š**ä»»ä½•é›†åˆçš„ä¿®æ”¹ï¼ˆä¾‹å¦‚ï¼Œå‘æ•°ç»„ä¸­æ·»åŠ ã€ç§»é™¤ä¸€ä¸ªå…ƒç´ æˆ–æ˜¯åš splice æ“ä½œï¼‰éƒ½éœ€è¦ä½ åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆ**ã€‚å› æ­¤ï¼Œ$patch æ–¹æ³•ä¹Ÿ**æ¥å—ä¸€ä¸ªå‡½æ•°**æ¥ç»„åˆè¿™ç§éš¾ä»¥ç”¨è¡¥ä¸å¯¹è±¡å®ç°çš„å˜æ›´ã€‚
```js
  store.$patch((state) => {
  state.items.push({ name: 'shoes', quantity: 1 })
  state.hasChanged = true
})
```

### è®¢é˜… state
**é€šè¿‡ store çš„ $subscribe() æ–¹æ³•ä¾¦å¬ state åŠå…¶å˜åŒ–**
```js
const cartStore = useSomeStore()
cartStore.$subscribe((mutation, state) => {
  // import { MutationType } from 'pinia'
  mutation.type // 'direct' | 'patch object' | 'patch function'
  // å’Œ cartStore.$id ä¸€æ ·
  mutation.storeId // 'cart'
  // åªæœ‰ mutation.type === 'patch object'çš„æƒ…å†µä¸‹æ‰å¯ç”¨
  mutation.payload // ä¼ é€’ç»™ cartStore.$patch() çš„è¡¥ä¸å¯¹è±¡ã€‚

  // æ¯å½“çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°†æ•´ä¸ª state æŒä¹…åŒ–åˆ°æœ¬åœ°å­˜å‚¨ã€‚
  localStorage.setItem('cart', JSON.stringify(state))
},{ detached: true })
```

> é»˜è®¤æƒ…å†µä¸‹ï¼Œstate subscription ä¼šè¢«ç»‘å®šåˆ°æ·»åŠ å®ƒä»¬çš„ç»„ä»¶ä¸Š (å¦‚æœ store åœ¨ç»„ä»¶çš„ setup() é‡Œé¢)ã€‚è¿™æ„å‘³ç€ï¼Œå½“è¯¥ç»„ä»¶è¢«å¸è½½æ—¶ï¼Œå®ƒä»¬å°†è¢«è‡ªåŠ¨åˆ é™¤ã€‚å¦‚æœä½ æƒ³åœ¨ç»„ä»¶å¸è½½åä¾æ—§ä¿ç•™å®ƒä»¬ï¼Œè¯·å°† { detached: true } ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œä»¥å°† state subscription ä»å½“å‰ç»„ä»¶ä¸­åˆ†ç¦»

**å¯ä»¥ä½¿ç”¨watchç›‘å¬æ•´ä¸ª state**
```js
watch(
  pinia.state,
  (state) => {
    // æ¯å½“çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°†æ•´ä¸ª state æŒä¹…åŒ–åˆ°æœ¬åœ°å­˜å‚¨ã€‚
    localStorage.setItem('piniaState', JSON.stringify(state))
  },
  { deep: true }
)
```

## 4.6 ã€Getterã€‘

### getter æ‹¿ä»€ä¹ˆæ¥è®¡ç®—ï¼Ÿ
- getter åŸºäº stateå‚æ•°
- ä¹Ÿå¯ä»¥é€šè¿‡ this è®¿é—®åˆ°æ•´ä¸ª store å®ä¾‹ï¼Œè¿™æ ·å¯ä»¥è®¿é—®åˆ°å…¶ä»–çš„getter
```js
export const useStore = defineStore('main', {
  state: () => ({
    count: 0,
  }),
  getters: {
    // è‡ªåŠ¨æ¨æ–­å‡ºè¿”å›ç±»å‹æ˜¯ä¸€ä¸ª number
    doubleCount(state) {
      return state.count * 2
    },
    // è¿”å›ç±»å‹**å¿…é¡»**æ˜ç¡®è®¾ç½®
    doublePlusOne(): number {
      // æ•´ä¸ª store çš„ è‡ªåŠ¨è¡¥å…¨å’Œç±»å‹æ ‡æ³¨ âœ¨
      return this.doubleCount + 1
    },
  },
})
```

### å‘ getter ä¼ é€’å‚æ•°
Getter åªæ˜¯å¹•åçš„è®¡ç®—å±æ€§ï¼Œæ‰€ä»¥ä¸å¯ä»¥å‘å®ƒä»¬ä¼ é€’ä»»ä½•å‚æ•°ã€‚ä¸è¿‡ï¼Œä½ å¯ä»¥**ä» getter è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å¯ä»¥æ¥å—ä»»æ„å‚æ•°**ï¼š

```js
export const useStore = defineStore('main', {
  getters: {
    getUserById: (state) => {
      return (userId) => state.users.find((user) => user.id === userId)
    },
  },
})
```
å¹¶åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ï¼š
```js
<script setup>
import { useUserListStore } from './store'
const userList = useUserListStore()
const { getUserById } = storeToRefs(userList)
// è¯·æ³¨æ„ï¼Œä½ éœ€è¦ä½¿ç”¨ `getUserById.value` æ¥è®¿é—®
// <script setup> ä¸­çš„å‡½æ•°
</script>

<template>
  <p>User 2: {{ getUserById(2) }}</p>
</template>
```

## 4.7ã€Actionã€‘
### è®¢é˜… action
**é€šè¿‡ store.$onAction() æ¥ç›‘å¬ action å’Œå®ƒä»¬çš„ç»“æœã€‚ä¼ é€’ç»™å®ƒçš„å›è°ƒå‡½æ•°ä¼šåœ¨ action æœ¬èº«ä¹‹å‰æ‰§è¡Œ**

> è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ï¼Œåœ¨è¿è¡Œ action ä¹‹å‰ä»¥åŠ action resolve/reject ä¹‹åæ‰“å°æ—¥å¿—è®°å½•ã€‚
```js
const unsubscribe = someStore.$onAction(
  ({
    name, // action åç§°
    store, // store å®ä¾‹ï¼Œç±»ä¼¼ `someStore`
    args, // ä¼ é€’ç»™ action çš„å‚æ•°æ•°ç»„
    after, // åœ¨ action è¿”å›æˆ–è§£å†³åçš„é’©å­
    onError, // action æŠ›å‡ºæˆ–æ‹’ç»çš„é’©å­
  }) => {
    // ä¸ºè¿™ä¸ªç‰¹å®šçš„ action è°ƒç”¨æä¾›ä¸€ä¸ªå…±äº«å˜é‡
    const startTime = Date.now()
    // è¿™å°†åœ¨æ‰§è¡Œ "store "çš„ action ä¹‹å‰è§¦å‘ã€‚
    console.log(`Start "${name}" with params [${args.join(', ')}].`)

    // è¿™å°†åœ¨ action æˆåŠŸå¹¶å®Œå…¨è¿è¡Œåè§¦å‘ã€‚
    // å®ƒç­‰å¾…ç€ä»»ä½•è¿”å›çš„ promise
    after((result) => {
      console.log(
        `Finished "${name}" after ${
          Date.now() - startTime
        }ms.\nResult: ${result}.`
      )
    })

    // å¦‚æœ action æŠ›å‡ºæˆ–è¿”å›ä¸€ä¸ªæ‹’ç»çš„ promiseï¼Œè¿™å°†è§¦å‘
    onError((error) => {
      console.warn(
        `Failed "${name}" after ${Date.now() - startTime}ms.\nError: ${error}.`
      )
    })
  }
)

// æ‰‹åŠ¨åˆ é™¤ç›‘å¬å™¨
unsubscribe()
```

**ç»§ç»­æ¬ç –**
é»˜è®¤æƒ…å†µä¸‹ï¼Œaction è®¢é˜…å™¨ä¼šè¢«ç»‘å®šåˆ°æ·»åŠ å®ƒä»¬çš„ç»„ä»¶ä¸Š(å¦‚æœ store åœ¨ç»„ä»¶çš„ setup() å†…)ã€‚è¿™æ„å‘³ç€ï¼Œå½“è¯¥ç»„ä»¶è¢«å¸è½½æ—¶ï¼Œå®ƒä»¬å°†è¢«è‡ªåŠ¨åˆ é™¤ã€‚å¦‚æœä½ æƒ³åœ¨ç»„ä»¶å¸è½½åä¾æ—§ä¿ç•™å®ƒä»¬ï¼Œè¯·å°† true ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ç»™ action è®¢é˜…å™¨ï¼Œä»¥ä¾¿å°†å…¶ä»å½“å‰ç»„ä»¶ä¸­åˆ†ç¦»ï¼š

```js
<script setup>
const someStore = useSomeStore()
// æ­¤è®¢é˜…å™¨å³ä¾¿åœ¨ç»„ä»¶å¸è½½ä¹‹åä»ä¼šè¢«ä¿ç•™
someStore.$onAction(callback, true)
</script>
```

# 5.ç»„ä»¶é€šä¿¡

## 5.1. ã€propsã€‘

æ¦‚è¿°ï¼š`props`æ˜¯ä½¿ç”¨é¢‘ç‡æœ€é«˜çš„ä¸€ç§é€šä¿¡æ–¹å¼ï¼Œå¸¸ç”¨ä¸ ï¼š**çˆ¶ â†” å­**ã€‚

- è‹¥ **çˆ¶ä¼ å­**ï¼šå±æ€§å€¼æ˜¯**éå‡½æ•°**ã€‚
- è‹¥ **å­ä¼ çˆ¶**ï¼šå±æ€§å€¼æ˜¯**å‡½æ•°**ã€‚

**å­ä¼ çˆ¶å°±æ˜¯è°ƒç”¨çˆ¶ç»„ä»¶çš„å‡½æ•°ï¼Œå¸¦å‚æ•°ä¼ è¿‡å»çš„ï¼ï¼ï¼**

çˆ¶ç»„ä»¶ï¼š

```html
<template>
  <div class="father">
    <h3>çˆ¶ç»„ä»¶ï¼Œ</h3>
		<h4>æˆ‘çš„è½¦ï¼š{{ car }}</h4>
		<h4>å„¿å­ç»™çš„ç©å…·ï¼š{{ toy }}</h4>
		<Child :car="car" :getToy="getToy"/>
  </div>
</template>

<script setup lang="ts" name="Father">
	import Child from './Child.vue'
	import { ref } from "vue";
	// æ•°æ®
	const car = ref('å¥”é©°')
	const toy = ref()
	// æ–¹æ³•
	function getToy(value:string){
		toy.value = value
	}
</script>
```

å­ç»„ä»¶

```html
<template>
  <div class="child">
    <h3>å­ç»„ä»¶</h3>
		<h4>æˆ‘çš„ç©å…·ï¼š{{ toy }}</h4>
		<h4>çˆ¶ç»™æˆ‘çš„è½¦ï¼š{{ car }}</h4>
		<button @click="getToy(toy)">ç©å…·ç»™çˆ¶äº²</button>
  </div>
</template>

<script setup lang="ts" name="Child">
	import { ref } from "vue";
	const toy = ref('å¥¥ç‰¹æ›¼')
	
	defineProps(['car','getToy'])
</script>
```

## 5.2 ã€mittã€‘

æ¦‚è¿°ï¼šä¸æ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒï¼ˆ`pubsub`ï¼‰åŠŸèƒ½ç±»ä¼¼ï¼Œå¯ä»¥å®ç°ä»»æ„ç»„ä»¶é—´é€šä¿¡ã€‚

å®‰è£…`mitt`

```shell
npm i mitt
```

æ–°å»ºæ–‡ä»¶ï¼š`src\utils\emitter.ts`

```javascript
// å¼•å…¥mitt 
import mitt from "mitt";

// åˆ›å»ºemitter
const emitter = mitt()

/*
  // ç»‘å®šäº‹ä»¶
  emitter.on('abc',(value)=>{
    console.log('abcäº‹ä»¶è¢«è§¦å‘',value)
  })
  emitter.on('xyz',(value)=>{
    console.log('xyzäº‹ä»¶è¢«è§¦å‘',value)
  })

  setInterval(() => {
    // è§¦å‘äº‹ä»¶
    emitter.emit('abc',666)
    emitter.emit('xyz',777)
  }, 1000);

  setTimeout(() => {
    // æ¸…ç†äº‹ä»¶
    emitter.all.clear()
  }, 3000); 
*/

// åˆ›å»ºå¹¶æš´éœ²mitt
export default emitter
```

æ¥æ”¶æ•°æ®çš„ç»„ä»¶ä¸­ï¼šç»‘å®šäº‹ä»¶ã€åŒæ—¶åœ¨é”€æ¯å‰è§£ç»‘äº‹ä»¶ï¼š

```typescript
import emitter from "@/utils/emitter";
import { onUnmounted } from "vue";

// ç»‘å®šäº‹ä»¶
emitter.on('send-toy',(value)=>{
  console.log('send-toyäº‹ä»¶è¢«è§¦å‘',value)
})

onUnmounted(()=>{
  // è§£ç»‘äº‹ä»¶
  emitter.off('send-toy')
})
```

ã€ç¬¬ä¸‰æ­¥ã€‘ï¼šæä¾›æ•°æ®çš„ç»„ä»¶ï¼Œåœ¨åˆé€‚çš„æ—¶å€™è§¦å‘äº‹ä»¶

```javascript
import emitter from "@/utils/emitter";

function sendToy(){
  // è§¦å‘äº‹ä»¶
  emitter.emit('send-toy',toy.value)
}
```

**æ³¨æ„è¿™ä¸ªé‡è¦çš„å†…ç½®å…³ç³»ï¼Œæ€»çº¿ä¾èµ–ç€è¿™ä¸ªå†…ç½®å…³ç³»**

## 5.3 ã€v-modelã€‘

### åŸç”Ÿinputä¸Šä½¿ç”¨v-model

é¦–å…ˆï¼ŒåŸç”Ÿæ˜¯è¿™æ ·ç”¨çš„ï¼š

```html
<input v-model="data" />
```

å…¶å®åœ¨vue2/3çš„èƒŒåï¼Œä¸Šé¢çš„è¿™ä¸ªä»£ç ç­‰ä»·äºä¸‹é¢è¿™è¡Œä»£ç ï¼š

```html
<input
  :value="data"
  @input="data = $event.target.value"
/>
```

å…¶å®çœ‹åˆ°è¿™é‡Œï¼Œåº”è¯¥æœ‰è€ƒè™‘è¿‡æˆ‘è¿˜èƒ½ç”¨emitäº‹ä»¶è§¦å‘å—ï¼Ÿä¸ä¼šå•¦ï¼Œå®ƒåªæ˜¯å¯¹äºå®ƒè‡ªå·±æœ¬èº«è¿›è¡Œæ“ä½œçš„ï¼Œåªæ˜¯æˆ‘ä»¬ä»Šå¤©é‡åˆ°çš„ä¸»è¦é—®é¢˜æ˜¯è¾“å…¥ç»„ä»¶ä¸Šç»‘å®šçš„v-modelï¼Œæˆ‘ä»¬æ€ä¹ˆé€šè¿‡ç»„ä»¶é‡Œé¢çš„ä»£ç è¿›è¡Œäº‹ä»¶çš„è§¦å‘ã€‚

### åœ¨ä¸€ä¸ªè¾“å…¥ç»„ä»¶ä¸Šä½¿ç”¨v-model

å…ˆçœ‹ç»„ä»¶ä¸Šï¼š

```html
<CustomInput v-model="searchText" />
```

åœ¨èƒŒåå®é™…ä¸Šè¢«å±•å¼€æˆï¼š

```html
<CustomInput
  :model-value="searchText"
  @update:model-value="newValue => searchText = newValue"
/>
<!-- æˆ–è€…ï¼š -->
<CustomInput
  :model-value="searchText"
  @update:model-value=" searchText = $event"
/>
```

> çœ‹å®˜ç½‘æ–‡æ¡£ä»‹ç»çš„é‡ç‚¹ï¼ï¼ï¼

è¦è®©è¿™ä¸ªä¾‹å­å®é™…å·¥ä½œèµ·æ¥ï¼Œ`<CustomInput>` ç»„ä»¶å†…éƒ¨éœ€è¦åšä¸¤ä»¶äº‹ï¼š

1. å°†å†…éƒ¨åŸç”Ÿ `<input>` å…ƒç´ çš„ `value` attribute ç»‘å®šåˆ° `modelValue` prop
2. å½“åŸç”Ÿçš„ `input` äº‹ä»¶è§¦å‘æ—¶ï¼Œè§¦å‘ä¸€ä¸ªæºå¸¦äº†æ–°å€¼çš„ `update:modelValue` è‡ªå®šä¹‰äº‹

> å†çœ‹çœ‹å®˜ç½‘ç»™çš„ä¾‹å­ï¼Œå°±çŸ¥é“çˆ¶å­ç»„ä»¶å…³äºæ•°æ®ä¼ è¾“çš„çœŸå®æƒ…å†µäº†ã€‚å®é™…ä¸Šåœ¨åšè¿™é¢˜ä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬åœ¨ç»„ä»¶ä¸­è§¦å‘çˆ¶ç»„ä»¶ä¸­çš„è¾“å…¥ç»„ä»¶çš„`update:modelValue`äº‹ä»¶ï¼Œé¡ºä¾¿å°†åŸç”Ÿè¾“å…¥æ¡†çš„å˜åŒ–å€¼å¸¦è¿‡å»ã€‚

```html
<!-- CustomInput.vue -->
<script setup>
defineProps(['modelValue'])
defineEmits(['update:modelValue'])
</script>

<template>
  <input
    :value="modelValue"
    @input="$emit('update:modelValue', $event.target.value)"
  />
</template>
```

> $event åˆ°åº•æ˜¯å•¥ï¼Ÿå•¥æ—¶å€™èƒ½.target
>
> å¯¹äºåŸç”Ÿäº‹ä»¶ï¼Œ$eventå°±æ˜¯äº‹ä»¶å¯¹è±¡===>èƒ½.target
>
> å¯¹äºè‡ªå®šä¹‰äº‹ä»¶ï¼Œ$eventå°±æ˜¯è§¦å‘äº‹ä»¶æ—¶ï¼Œä¼ é€’çš„æ•°æ® ===> ä¸èƒ½.target

**ä¸‹é¢åˆæ˜¯æ¬ç –ï¼ï¼ï¼**

**v-model çš„å‚æ•°â€‹**
é»˜è®¤æƒ…å†µä¸‹ï¼Œv-model åœ¨ç»„ä»¶ä¸Šéƒ½æ˜¯ä½¿ç”¨ modelValue ä½œä¸º propï¼Œå¹¶ä»¥ update:modelValue ä½œä¸ºå¯¹åº”çš„äº‹ä»¶ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»™ v-model æŒ‡å®šä¸€ä¸ªå‚æ•°æ¥æ›´æ”¹è¿™äº›åå­—ï¼š

```html
<MyComponent v-model:title="bookTitle" />
```
åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå­ç»„ä»¶åº”å£°æ˜ä¸€ä¸ª title propï¼Œå¹¶é€šè¿‡è§¦å‘ update:title äº‹ä»¶æ›´æ–°çˆ¶ç»„ä»¶å€¼ï¼š

```html
<!-- MyComponent.vue -->
<script setup>
defineProps(['title'])
defineEmits(['update:title'])
</script>

<template>
  <input
    type="text"
    :value="title"
    @input="$emit('update:title', $event.target.value)"
  />
</template>
```

**å¤šä¸ª v-model ç»‘å®šâ€‹**
åˆ©ç”¨åˆšæ‰åœ¨ v-model å‚æ•°å°èŠ‚ä¸­å­¦åˆ°çš„æŒ‡å®šå‚æ•°ä¸äº‹ä»¶åçš„æŠ€å·§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å•ä¸ªç»„ä»¶å®ä¾‹ä¸Šåˆ›å»ºå¤šä¸ª v-model åŒå‘ç»‘å®šã€‚

ç»„ä»¶ä¸Šçš„æ¯ä¸€ä¸ª v-model éƒ½ä¼šåŒæ­¥ä¸åŒçš„ propï¼Œè€Œæ— éœ€é¢å¤–çš„é€‰é¡¹ï¼š

```html
<UserName
  v-model:first-name="first"
  v-model:last-name="last"
/>
```
```html
<script setup>
defineProps({
  firstName: String,
  lastName: String
})

defineEmits(['update:firstName', 'update:lastName'])
</script>

<template>
  <input
    type="text"
    :value="firstName"
    @input="$emit('update:firstName', $event.target.value)"
  />
  <input
    type="text"
    :value="lastName"
    @input="$emit('update:lastName', $event.target.value)"
  />
</template>
```

## 5.4ã€$attrs ã€‘

1. æ¦‚è¿°ï¼š`$attrs`ç”¨äºå®ç°**å½“å‰ç»„ä»¶çš„çˆ¶ç»„ä»¶**ï¼Œå‘**å½“å‰ç»„ä»¶çš„å­ç»„ä»¶**é€šä¿¡ï¼ˆ**ç¥–â†’å­™**ï¼‰ã€‚

2. å…·ä½“è¯´æ˜ï¼š`$attrs`æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«æ‰€æœ‰çˆ¶ç»„ä»¶ä¼ å…¥çš„æ ‡ç­¾å±æ€§ã€‚

   >  æ³¨æ„ï¼š`$attrs`ä¼šè‡ªåŠ¨æ’é™¤`props`ä¸­å£°æ˜çš„å±æ€§(å¯ä»¥è®¤ä¸ºå£°æ˜è¿‡çš„ `props` è¢«å­ç»„ä»¶è‡ªå·±â€œæ¶ˆè´¹â€äº†)

çˆ¶ç»„ä»¶ï¼š

```html
<template>
  <div class="father">
    <h3>çˆ¶ç»„ä»¶</h3>
		<Child :a="a" :b="b" :c="c" :d="d" v-bind="{x:100,y:200}" :updateA="updateA"/>
  </div>
</template>

<script setup lang="ts" name="Father">
	import Child from './Child.vue'
	import { ref } from "vue";
	let a = ref(1)
	let b = ref(2)
	let c = ref(3)
	let d = ref(4)

	function updateA(value){
		a.value = value
	}
</script>
```

å­ç»„ä»¶ï¼š

```html
<template>
	<div class="child">
		<h3>å­ç»„ä»¶</h3>
		<GrandChild v-bind="$attrs"/>
	</div>
</template>

<script setup lang="ts" name="Child">
	import GrandChild from './GrandChild.vue'
</script>
```

å­™ç»„ä»¶ï¼š

```html
<template>
	<div class="grand-child">
		<h3>å­™ç»„ä»¶</h3>
		<h4>aï¼š{{ a }}</h4>
		<h4>bï¼š{{ b }}</h4>
		<h4>cï¼š{{ c }}</h4>
		<h4>dï¼š{{ d }}</h4>
		<h4>xï¼š{{ x }}</h4>
		<h4>yï¼š{{ y }}</h4>
		<button @click="updateA(666)">ç‚¹æˆ‘æ›´æ–°A</button>
	</div>
</template>

<script setup lang="ts" name="GrandChild">
	defineProps(['a','b','c','d','x','y','updateA'])
</script>
```


## 5.5 ã€\$refsã€$parentã€‘

1. æ¦‚è¿°ï¼š

   * `$refs`ç”¨äº ï¼š**çˆ¶â†’å­ã€‚**
   * `$parent`ç”¨äºï¼š**å­â†’çˆ¶ã€‚**

2. åŸç†å¦‚ä¸‹ï¼š

   | å±æ€§      | è¯´æ˜                                                     |
      | --------- | -------------------------------------------------------- |
   | `$refs`   | å€¼ä¸ºå¯¹è±¡ï¼ŒåŒ…å«æ‰€æœ‰è¢«`ref`å±æ€§æ ‡è¯†çš„`DOM`å…ƒç´ æˆ–ç»„ä»¶å®ä¾‹ã€‚ |
   | `$parent` | å€¼ä¸ºå¯¹è±¡ï¼Œå½“å‰ç»„ä»¶çš„çˆ¶ç»„ä»¶å®ä¾‹å¯¹è±¡ã€‚                     |

## 5.6 ã€provideã€injectã€‘

1. æ¦‚è¿°ï¼šå®ç°**ç¥–å­™ç»„ä»¶**ç›´æ¥é€šä¿¡

2. å…·ä½“ä½¿ç”¨ï¼š

   * åœ¨ç¥–å…ˆç»„ä»¶ä¸­é€šè¿‡`provide`é…ç½®å‘åä»£ç»„ä»¶æä¾›æ•°æ®
   * åœ¨åä»£ç»„ä»¶ä¸­é€šè¿‡`inject`é…ç½®æ¥å£°æ˜æ¥æ”¶æ•°æ®

4. å…·ä½“ç¼–ç ï¼š

   ã€ç¬¬ä¸€æ­¥ã€‘çˆ¶ç»„ä»¶ä¸­ï¼Œä½¿ç”¨`provide`æä¾›æ•°æ®

   ```vue
   <template>
     <div class="father">
       <h3>çˆ¶ç»„ä»¶</h3>
       <h4>èµ„äº§ï¼š{{ money }}</h4>
       <h4>æ±½è½¦ï¼š{{ car }}</h4>
       <button @click="money += 1">èµ„äº§+1</button>
       <button @click="car.price += 1">æ±½è½¦ä»·æ ¼+1</button>
       <Child/>
     </div>
   </template>
   
   <script setup lang="ts" name="Father">
     import Child from './Child.vue'
     import { ref,reactive,provide } from "vue";
     // æ•°æ®
     let money = ref(100)
     let car = reactive({
       brand:'å¥”é©°',
       price:100
     })
     // ç”¨äºæ›´æ–°moneyçš„æ–¹æ³•
     function updateMoney(value:number){
       money.value += value
     }
     // æä¾›æ•°æ®
     provide('moneyContext',{money,updateMoney})
     provide('car',car)
   </script>
   ```

   > æ³¨æ„ï¼šå­ç»„ä»¶ä¸­ä¸ç”¨ç¼–å†™ä»»ä½•ä¸œè¥¿ï¼Œæ˜¯ä¸å—åˆ°ä»»ä½•æ‰“æ‰°çš„

   ã€ç¬¬äºŒæ­¥ã€‘å­™ç»„ä»¶ä¸­ä½¿ç”¨`inject`é…ç½®é¡¹æ¥å—æ•°æ®ã€‚

   ```vue
   <template>
     <div class="grand-child">
       <h3>æˆ‘æ˜¯å­™ç»„ä»¶</h3>
       <h4>èµ„äº§ï¼š{{ money }}</h4>
       <h4>æ±½è½¦ï¼š{{ car }}</h4>
       <button @click="updateMoney(6)">ç‚¹æˆ‘</button>
     </div>
   </template>
   
   <script setup lang="ts" name="GrandChild">
     import { inject } from 'vue';
     // æ³¨å…¥æ•°æ®
    let {money,updateMoney} = inject('moneyContext',{money:0,updateMoney:(x:number)=>{}})
     let car = inject('car')
</script>
   ```

## 5.7 ã€slotã€‘

### 1. é»˜è®¤æ’æ§½


```html
çˆ¶ç»„ä»¶ä¸­ï¼š
        <Category title="ä»Šæ—¥çƒ­é—¨æ¸¸æˆ">
          <ul>
            <li v-for="g in games" :key="g.id">{{ g.name }}</li>
          </ul>
        </Category>
å­ç»„ä»¶ä¸­ï¼š
        <template>
          <div class="item">
            <h3>{{ title }}</h3>
            <!-- é»˜è®¤æ’æ§½ -->
            <slot></slot>
          </div>
        </template>
```

### 2. å…·åæ’æ§½

```html
çˆ¶ç»„ä»¶ä¸­ï¼š
        <Category title="ä»Šæ—¥çƒ­é—¨æ¸¸æˆ">
          <template v-slot:s1><!-- ä¹Ÿå¯ä»¥æ˜¯ #s1 -->
            <ul>
              <li v-for="g in games" :key="g.id">{{ g.name }}</li>
            </ul>
          </template>
          <template #s2>
            <a href="">æ›´å¤š</a>
          </template>
        </Category>
å­ç»„ä»¶ä¸­ï¼š
        <template>
          <div class="item">
            <h3>{{ title }}</h3>
            <slot name="s1"></slot>
            <slot name="s2"></slot>
          </div>
        </template>
```

### 3. ä½œç”¨åŸŸæ’æ§½

1. ç†è§£ï¼š<span style="color:red">æ•°æ®åœ¨ç»„ä»¶çš„è‡ªèº«ï¼Œä½†æ ¹æ®æ•°æ®ç”Ÿæˆçš„ç»“æ„éœ€è¦ç»„ä»¶çš„ä½¿ç”¨è€…æ¥å†³å®šã€‚</span>ï¼ˆæ–°é—»æ•°æ®åœ¨`News`ç»„ä»¶ä¸­ï¼Œä½†ä½¿ç”¨æ•°æ®æ‰€éå†å‡ºæ¥çš„ç»“æ„ç”±`App`ç»„ä»¶å†³å®šï¼‰

3. å…·ä½“ç¼–ç ï¼š

   ```html
   çˆ¶ç»„ä»¶ä¸­ï¼š
         <Game v-slot="params">
         <!-- <Game v-slot:default="params"> -->
         <!-- <Game #default="params"> -->
           <ul>
             <li v-for="g in params.games" :key="g.id">{{ g.name }}</li>
           </ul>
         </Game>
   
   å­ç»„ä»¶ä¸­ï¼š
         <template>
           <div class="category">
             <h2>ä»Šæ—¥æ¸¸æˆæ¦œå•</h2>
             <slot :games="games" a="å“ˆå“ˆ"></slot>
           </div>
         </template>
   
         <script setup lang="ts" name="Category">
           import {reactive} from 'vue'
           let games = reactive([
             {id:'asgdytsa01',name:'è‹±é›„è”ç›Ÿ'},
             {id:'asgdytsa02',name:'ç‹è€…è£è€€'},
             {id:'asgdytsa03',name:'çº¢è‰²è­¦æˆ’'},
             {id:'asgdytsa04',name:'æ–—ç½—å¤§é™†'}
           ])
         </script>
   ```



# 6.å…¶å®ƒ API

## 6.1ã€shallowRef ä¸ shallowReactive ã€‘

### `shallowRef`

1. ä½œç”¨ï¼šåˆ›å»ºä¸€ä¸ªå“åº”å¼æ•°æ®ï¼Œä½†åªå¯¹é¡¶å±‚å±æ€§è¿›è¡Œå“åº”å¼å¤„ç†ã€‚

2. ç”¨æ³•ï¼š

   ```js
   let myVar = shallowRef(initialValue);
   ```

3. ç‰¹ç‚¹ï¼šåªè·Ÿè¸ªå¼•ç”¨å€¼çš„å˜åŒ–ï¼Œä¸å…³å¿ƒå€¼å†…éƒ¨çš„å±æ€§å˜åŒ–ã€‚

### `shallowReactive`

1. ä½œç”¨ï¼šåˆ›å»ºä¸€ä¸ªæµ…å±‚å“åº”å¼å¯¹è±¡ï¼Œåªä¼šä½¿å¯¹è±¡çš„æœ€é¡¶å±‚å±æ€§å˜æˆå“åº”å¼çš„ï¼Œå¯¹è±¡å†…éƒ¨çš„åµŒå¥—å±æ€§åˆ™ä¸ä¼šå˜æˆå“åº”å¼çš„

2. ç”¨æ³•ï¼š

   ```js
   const myObj = shallowReactive({ ... });
   ```

3. ç‰¹ç‚¹ï¼šå¯¹è±¡çš„é¡¶å±‚å±æ€§æ˜¯å“åº”å¼çš„ï¼Œä½†åµŒå¥—å¯¹è±¡çš„å±æ€§ä¸æ˜¯ã€‚

### æ€»ç»“

> é€šè¿‡ä½¿ç”¨ [`shallowRef()`](https://cn.vuejs.org/api/reactivity-advanced.html#shallowref) å’Œ [`shallowReactive()`](https://cn.vuejs.org/api/reactivity-advanced.html#shallowreactive) æ¥ç»•å¼€æ·±åº¦å“åº”ã€‚æµ…å±‚å¼ `API` åˆ›å»ºçš„çŠ¶æ€åªåœ¨å…¶é¡¶å±‚æ˜¯å“åº”å¼çš„ï¼Œå¯¹æ‰€æœ‰æ·±å±‚çš„å¯¹è±¡ä¸ä¼šåšä»»ä½•å¤„ç†ï¼Œé¿å…äº†å¯¹æ¯ä¸€ä¸ªå†…éƒ¨å±æ€§åšå“åº”å¼æ‰€å¸¦æ¥çš„æ€§èƒ½æˆæœ¬ï¼Œè¿™ä½¿å¾—å±æ€§çš„è®¿é—®å˜å¾—æ›´å¿«ï¼Œå¯æå‡æ€§èƒ½ã€‚



## 6.2ã€readonly ä¸ shallowReadonlyã€‘

### **`readonly`**

1. ä½œç”¨ï¼šç”¨äºåˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„æ·±åªè¯»å‰¯æœ¬ã€‚

2. ç”¨æ³•ï¼š

   ```js
   const original = reactive({ ... });
   const readOnlyCopy = readonly(original);
   ```

3. ç‰¹ç‚¹ï¼š

   * å¯¹è±¡çš„æ‰€æœ‰åµŒå¥—å±æ€§éƒ½å°†å˜ä¸ºåªè¯»ã€‚
   * ä»»ä½•å°è¯•ä¿®æ”¹è¿™ä¸ªå¯¹è±¡çš„æ“ä½œéƒ½ä¼šè¢«é˜»æ­¢ï¼ˆåœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼Œè¿˜ä¼šåœ¨æ§åˆ¶å°ä¸­å‘å‡ºè­¦å‘Šï¼‰ã€‚

4. åº”ç”¨åœºæ™¯ï¼š
   * åˆ›å»ºä¸å¯å˜çš„çŠ¶æ€å¿«ç…§ã€‚
   * ä¿æŠ¤å…¨å±€çŠ¶æ€æˆ–é…ç½®ä¸è¢«ä¿®æ”¹ã€‚

### **`shallowReadonly`**

1. ä½œç”¨ï¼šä¸ `readonly` ç±»ä¼¼ï¼Œä½†åªä½œç”¨äºå¯¹è±¡çš„é¡¶å±‚å±æ€§ã€‚

2. ç”¨æ³•ï¼š

   ```js
   const original = reactive({ ... });
   const shallowReadOnlyCopy = shallowReadonly(original);
   ```

3. ç‰¹ç‚¹ï¼š

   * åªå°†å¯¹è±¡çš„é¡¶å±‚å±æ€§è®¾ç½®ä¸ºåªè¯»ï¼Œå¯¹è±¡å†…éƒ¨çš„åµŒå¥—å±æ€§ä»ç„¶æ˜¯å¯å˜çš„ã€‚

   * é€‚ç”¨äºåªéœ€ä¿æŠ¤å¯¹è±¡é¡¶å±‚å±æ€§çš„åœºæ™¯ã€‚


## 6.3ã€toRaw ä¸ markRawã€‘

### `toRaw`

1. ä½œç”¨ï¼šç”¨äºè·å–ä¸€ä¸ªå“åº”å¼å¯¹è±¡çš„åŸå§‹å¯¹è±¡ï¼Œ `toRaw` è¿”å›çš„å¯¹è±¡ä¸å†æ˜¯å“åº”å¼çš„ï¼Œä¸ä¼šè§¦å‘è§†å›¾æ›´æ–°ã€‚

   > å®˜ç½‘æè¿°ï¼šè¿™æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨äºä¸´æ—¶è¯»å–è€Œä¸å¼•èµ·ä»£ç†è®¿é—®/è·Ÿè¸ªå¼€é”€ï¼Œæˆ–æ˜¯å†™å…¥è€Œä¸è§¦å‘æ›´æ”¹çš„ç‰¹æ®Šæ–¹æ³•ã€‚ä¸å»ºè®®ä¿å­˜å¯¹åŸå§‹å¯¹è±¡çš„æŒä¹…å¼•ç”¨ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚

   > ä½•æ—¶ä½¿ç”¨ï¼Ÿ â€”â€” åœ¨éœ€è¦å°†å“åº”å¼å¯¹è±¡ä¼ é€’ç»™é `Vue` çš„åº“æˆ–å¤–éƒ¨ç³»ç»Ÿæ—¶ï¼Œä½¿ç”¨ `toRaw` å¯ä»¥ç¡®ä¿å®ƒä»¬æ”¶åˆ°çš„æ˜¯æ™®é€šå¯¹è±¡

2. å…·ä½“ç¼–ç ï¼š

   ```js
   import { reactive,toRaw,markRaw,isReactive } from "vue";
   
   /* toRaw */
   // å“åº”å¼å¯¹è±¡
   let person = reactive({name:'tony',age:18})
   // åŸå§‹å¯¹è±¡
   let rawPerson = toRaw(person)
   
   
   /* markRaw */
   let citysd = markRaw([
     {id:'asdda01',name:'åŒ—äº¬'},
     {id:'asdda02',name:'ä¸Šæµ·'},
     {id:'asdda03',name:'å¤©æ´¥'},
     {id:'asdda04',name:'é‡åº†'}
   ])
   // æ ¹æ®åŸå§‹å¯¹è±¡cityså»åˆ›å»ºå“åº”å¼å¯¹è±¡citys2 â€”â€” åˆ›å»ºå¤±è´¥ï¼Œå› ä¸ºcitysè¢«markRawæ ‡è®°äº†
   let citys2 = reactive(citys)
   console.log(isReactive(person))
   console.log(isReactive(rawPerson))
   console.log(isReactive(citys))
   console.log(isReactive(citys2))
   ```

### `markRaw`

1. ä½œç”¨ï¼šæ ‡è®°ä¸€ä¸ªå¯¹è±¡ï¼Œä½¿å…¶**æ°¸è¿œä¸ä¼š**å˜æˆå“åº”å¼çš„ã€‚

   > ä¾‹å¦‚ä½¿ç”¨`mockjs`æ—¶ï¼Œä¸ºäº†é˜²æ­¢è¯¯æŠŠ`mockjs`å˜ä¸ºå“åº”å¼å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ `markRaw` å»æ ‡è®°`mockjs`

2. ç¼–ç ï¼š

   ```js
   /* markRaw */
   let citys = markRaw([
     {id:'asdda01',name:'åŒ—äº¬'},
     {id:'asdda02',name:'ä¸Šæµ·'},
     {id:'asdda03',name:'å¤©æ´¥'},
     {id:'asdda04',name:'é‡åº†'}
   ])
   // æ ¹æ®åŸå§‹å¯¹è±¡cityså»åˆ›å»ºå“åº”å¼å¯¹è±¡citys2 â€”â€” åˆ›å»ºå¤±è´¥ï¼Œå› ä¸ºcitysè¢«markRawæ ‡è®°äº†
   let citys2 = reactive(citys)
   ```

## 6.4ã€customRefã€‘
> è¿™é‡Œå¯¹äºtrack,triggerå¯èƒ½ä¼šè€ƒé¢è¯•é¢˜ï¼ï¼ï¼

ä½œç”¨ï¼šåˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„`ref`ï¼Œå¹¶å¯¹å…¶ä¾èµ–é¡¹è·Ÿè¸ªå’Œæ›´æ–°è§¦å‘è¿›è¡Œé€»è¾‘æ§åˆ¶ã€‚

å®ç°é˜²æŠ–æ•ˆæœï¼ˆ`useSumRef.ts`ï¼‰ï¼š

```typescript
import {customRef } from "vue";

export default function(initValue:string,delay:number){
  let msg = customRef((track,trigger)=>{
    let timer:number
    return {
    //getä»€ä¹ˆæ—¶å€™è°ƒç”¨ï¼Ÿâ€”â€”msgè¢«è¯»å–æ—¶
      get(){
        track() // å‘Šè¯‰Vueæ•°æ®msgå¾ˆé‡è¦ï¼Œè¦å¯¹msgæŒç»­å…³æ³¨ï¼Œä¸€æ—¦å˜åŒ–å°±æ›´æ–°
        return initValue
      },
      //setä»€ä¹ˆæ—¶å€™è°ƒç”¨ï¼Ÿâ€”â€”msgè¢«ä¿®æ”¹æ—¶
      set(value){
        clearTimeout(timer)
        timer = setTimeout(() => {
          initValue = value
          trigger() //é€šçŸ¥Vueæ•°æ®msgå˜åŒ–äº†
        }, delay);
      }
    }
  }) 
  return {msg}
}
```

# 7.Vue3æ–°ç»„ä»¶

## 7.1 ã€Teleportã€‘

- ä»€ä¹ˆæ˜¯Teleportï¼Ÿâ€”â€” Teleport æ˜¯ä¸€ç§èƒ½å¤Ÿå°†æˆ‘ä»¬çš„**ç»„ä»¶htmlç»“æ„**ç§»åŠ¨åˆ°æŒ‡å®šä½ç½®çš„æŠ€æœ¯ã€‚
- ä¸‹é¢è¿™ä¸ªtoä¸­çš„å€¼æ˜¯é€‰æ‹©å™¨å±æ€§å€¼ã€‚
```html
<teleport to='body' >
    <div class="modal" v-show="isShow">
      <h2>æˆ‘æ˜¯ä¸€ä¸ªå¼¹çª—</h2>
      <p>æˆ‘æ˜¯å¼¹çª—ä¸­çš„ä¸€äº›å†…å®¹</p>
      <button @click="isShow = false">å…³é—­å¼¹çª—</button>
    </div>
</teleport>
```

## 7.2 ã€Suspenseã€‘

-  ç­‰å¾…å¼‚æ­¥ç»„ä»¶æ—¶æ¸²æŸ“ä¸€äº›é¢å¤–å†…å®¹ï¼Œè®©åº”ç”¨æœ‰æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ
-  ä½¿ç”¨æ­¥éª¤ï¼š
   -  å¼‚æ­¥å¼•å…¥ç»„ä»¶
   -  ä½¿ç”¨`Suspense`åŒ…è£¹ç»„ä»¶ï¼Œå¹¶é…ç½®å¥½`default` ä¸ `fallback`

```tsx
import { defineAsyncComponent,Suspense } from "vue";
const Child = defineAsyncComponent(()=>import('./Child.vue'))
```

```vue
<template>
    <div class="app">
        <h3>æˆ‘æ˜¯Appç»„ä»¶</h3>
        <Suspense>
          <template v-slot:default>
            <Child/>
          </template>
          <template v-slot:fallback>
            <h3>åŠ è½½ä¸­.......</h3>
          </template>
        </Suspense>
    </div>
</template>
```



## 7.3ã€å…¨å±€APIè½¬ç§»åˆ°åº”ç”¨å¯¹è±¡ã€‘

- `app.component`
- `app.config`
- `app.directive`
- `app.mount`
- `app.unmount`
- `app.use`

## 7.4ã€å…¶ä»–ã€‘

- è¿‡æ¸¡ç±»å `v-enter` ä¿®æ”¹ä¸º `v-enter-from`ã€è¿‡æ¸¡ç±»å `v-leave` ä¿®æ”¹ä¸º `v-leave-from`ã€‚


- `keyCode` ä½œä¸º `v-on` ä¿®é¥°ç¬¦çš„æ”¯æŒã€‚

- `v-model` æŒ‡ä»¤åœ¨ç»„ä»¶ä¸Šçš„ä½¿ç”¨å·²ç»è¢«é‡æ–°è®¾è®¡ï¼Œæ›¿æ¢æ‰äº† `v-bind.syncã€‚`

- `v-if` å’Œ `v-for` åœ¨åŒä¸€ä¸ªå…ƒç´ èº«ä¸Šä½¿ç”¨æ—¶çš„ä¼˜å…ˆçº§å‘ç”Ÿäº†å˜åŒ–ã€‚

- ç§»é™¤äº†`$on`ã€`$off` å’Œ `$once` å®ä¾‹æ–¹æ³•ã€‚

- ç§»é™¤äº†è¿‡æ»¤å™¨ `filter`ã€‚

- ç§»é™¤äº†`$children` å®ä¾‹ `propert`ã€‚

  ......
